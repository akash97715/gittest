[12:15 AM] Deep, Akash (External)
---------------------------------------------------------------------------UnboundLocalError                         Traceback (most recent call last)Cell In[20], line 8      1 import pprint      3 inputs = {      4     "messages": [      5         ("user", "What are different type world mountains"),      6     ]      7 }----> 8 for output in graph.stream(inputs):      9     for key, value in output.items():     10         pprint.pprint(f"Output from node '{key}':") File d:\agentenv\Lib\site-packages\langgraph\pregel\__init__.py:963, in Pregel.stream(self, input, config, stream_mode, output_keys, input_keys, interrupt_before, interrupt_after, debug)    960         del fut, task    962 # panic on failure or timeout--> 963 _panic_or_proceed(done, inflight, step)    964 # don't keep futures around in memory longer than needed    965 del done, inflight, futures File d:\agentenv\Lib\site-packages\langgraph\pregel\__init__.py:1489, in _panic_or_proceed(done, inflight, step)   1487             inflight.pop().cancel()   1488         # raise the exception-> 1489         raise exc   1491 if inflight:
...
--> 150 llm = llm    152 # Post-processing    153 def format_docs(docs): UnboundLocalError: cannot access local variable 'llm' where it is not associated with a value
Output is truncated. View as a scrollable element or open in a text editor. Adjust cell output settings...
[12:15 AM] Deep, Akash (External)
June 10, 2024 > 18:44:22 | INFO | utils.ias_openai_langchain:_generate:1129 | total token by system_message, user_query, kwargs[tools] is - 299 June 10, 2024 > 18:44:22 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:372 | Calling chat completion endpoint with tools June 10, 2024 > 18:44:22 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:373 | {'engine': 'gpt-4', 'messages': [{'role': 'user', 'content': 'What are different type world mountains'}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'assistant', 'content': 'Hi'}], 'temperature': 0.7, 'max_tokens': 2701, 'tools': [{'type': 'function', 'function': {'name': 'retrieve_blog_posts', 'description': 'If the query discuss about world mountains.', 'parameters': {'type': 'object', 'properties': {'query': {'description': 'query to look up in retriever', 'type': 'string'}}, 'required': ['query']}}}], 'tool_choice': 'auto'}
---CALL AGENT---
June 10, 2024 > 18:44:25 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:377 | Received response from llm June 10, 2024 > 18:44:25 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:378 | {'status': 'success', 'result': '{"content": null, "role": "assistant", "tool_calls": [{"function": {"arguments": "{\\n  \\"query\\": \\"different types of world mountains\\"\\n}", "name": "retrieve_blog_posts"}, "id": "call_ngjKUKzmYhFSerhxGAPEhQ3D", "type": "function"}]}', 'totalTokens': 101} June 10, 2024 > 18:44:25 | DEBUG | utils.ias_openai_langchain:_generate:1146 | Total tokens consumed: 101 June 10, 2024 > 18:44:25 | INFO | utils.ias_openai_langchain:ias_openai_embeddings:423 | Triggering embedding endpoint
"Output from node 'agent':"'---'{ 'messages': [ AIMessage(content='', additional_kwargs={'tool_calls': [{'function': {'arguments': '{\n  "query": "different types of world mountains"\n}', 'name': 'retrieve_blog_posts'}, 'id': 'call_ngjKUKzmYhFSerhxGAPEhQ3D', 'type': 'function'}]}, response_metadata={'token_usage': 0, 'model_name': 'gpt-4', 'finish_reason': 'stop'}, id='run-1bdb6630-fbd4-4e95-82fa-995d6a4a6091-0', tool_calls=[{'name': 'retrieve_blog_posts', 'args': {'query': 'different types of world mountains'}, 'id': 'call_ngjKUKzmYhFSerhxGAPEhQ3D'}])]}'\n---\n'
June 10, 2024 > 18:44:27 | INFO | utils.ias_openai_langchain:ias_openai_embeddings:438 | Recevied response from embedding endpoint June 10, 2024 > 18:44:27 | INFO | utils.ias_openai_langchain:_generate:1129 | total token by system_message, user_query, kwargs[tools] is - 1800 June 10, 2024 > 18:44:27 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:372 | Calling chat completion endpoint with tools June 10, 2024 > 18:44:27 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:373 | {'engine': 'gpt-4', 'messages': [{'role': 'user', 'content': "You are a grader assessing relevance of a retrieved document to a user question. \n \n        Here is the retrieved document: \n\n Label the Map\nHimalaya Mountains\nIndian Ocean\nArabian Sea\nBangaloreNew Delhi\nMumbai\nKalkutta\n\n© Roger N. Anderson\n15Volcanoes and Plate Tectonics\nThe continents  grow by this same collision process because they are made up of\nrock that is lighter than oceanic rock and thus more difficult to subduct. Some of this\nlight rock is “scraped-off”. Also, at subduction zones, the oceanic plate is melted back\ninto the mantle and the lightest and most buoyant of this magma escapes back to the\nsurface forming volcanoes.  This combination creates the largest mountain ranges on\nEarth, such as the Andes, the Sierra Nevadas, and the Himalayas (Figure 3-12). These\nmountain ranges are the predominant mechanism by which the continents grow new rock.\nThis subduction process is also one of the reasons why earthquakes and volcanoes occur\nat the same places on the planet.\nThe sea floor is relatively simple geologically because it is never at the surface to\nsuffer erosion. All sea floor older than 160 million years has been subducted back into the\nmantle. Complexity is bred by multiple overprinting events through a long geological\nhistory. The longer a feature remains on the surface, the more complex and more difficult\nto decipher it becomes. Thus, plate tectonics was not discovered until the simplicity of\nthe ocean floor was realized. The continents are light, and they float like blocks of wood\nin the bathtub of the heavy ocean-floor rock. They float because they are made of some\nof the lightest rock on the planet. Continents are hard to force down a subduction zone\nbecause they are so light. Therefore, continents have grown throughout geological time\nand so are much more complex than the oceans. More on that in Topic 4.\nFigure 3-12. The magnetic stripes off the western U.S.show sea floor about to be subducted beneath\nWashington, Oregon, and Northern California resulting in volcanoes like Mts. Ranier, Hood, and St.\nHelens.\n\n© Roger N. Anderson\n22zone must overcome the hydrostatic weight of the entire column of water standing in the\nmineral lattices.\nMost of the activity that affects man in a subduction zone occurs landward of the\nAccretionary wedge and trench axis. Volcanoes made from dewatering of the downgoing\nslab come to the surface in either continental mountains or in island arcs, but always on\nthe landward side. Whether the volcanoes form islands or become part of a large\nmountain range has to do with the previous geological history of the plate margin\ncolliding with the subducting plate. If it is continental, a mountain range will be formed\nbecause all the volcanic activity from subduction will be piled on top of an already\nemergent coastline. Examples are the Andes of South America and the volcanoes of\nCentral America. If however, the overriding plate is oceanic, new volcanoes must begin\nby piling lavas onto the sea floor. They emerge as islands only after they have flowed\nenough magma to build a pyramid tall enough to break the sea surface.  Examples are\nGuam in the west Pacific where the Pacific plate is subducting beneath the Philippine\nplate and the Sandwich Islands between South America and Antarctica where the Atlantic\nplate is subducting beneath the Scotia plate (Figure 3-16).\nFigure 3-16. Island arcs can be seen in the western Pacific (upper left) and the southern Atlantic (lower\nright) where subduction is of an oceanic plate beneath another oceanic plate.\nIsland arcs are the early beginnings of new continents. They are arcuate (curved)\nbecause the subducting slab is a plane penetrating into a sphere. The surface expressions\nof volcanic plumes moving directly to the surface from such a plane define an arc.\nVolcanoes appear at the surface spaced about 100 km apart. That is the segregation\ndistance for the production of enough magma along the slab to produce individual\nmagma diapirs, which then congeal and move upward to the surface. If volcanism\ncontinues, enough rock is extruded to completely fill all the space between individual\nvolcanoes to the point that sea level is exceeded even between volcanoes and a new\ncontinent appears.\n\n© Roger N. Anderson\n4Each of these three plate boundaries is characterized by a different kind of force:\ntension from extension at mid-ocean ridge spreading center boundaries; compression\nfrom collision at subduction zones; and shearing from tearing at transform faults (figure\n3-3).\nFigure 3-3. The three types of Plate boundaries are shown at top, and where they occur within a cross\nsection of the Nazca and Pacific Plates sliced open from South America on the right to Tahiti on the left.\nEvidence for Plate Tectonics\nHow is it that we know that the Earth is covered with a mosaic of rigid plates, and\nthat these plates interact with each other only at their common boundaries. The discovery\nat the foundation of Plate Tectonics is that the surface of the Earth is capped by rigid\nouter or lithospheric plates that are only a hundred kilometers or so thick.  These plates\n“float” on a softer, partially liquid upper mantle.\nSeismology provides the most compelling evidence for the existence of these\nlithospheric plates. Earthquakes predominantly occur only along plate boundaries\n(shallow earthquakes in black in figure 3-4), and not inside the interior of the plates.\nSimply observing where the earthquakes are delineates the plate boundaries.  Deep (in\nred, Figure 3-4) and intermediate depth earthquakes (green in Figure 3-4) define the\nsubduction back into the mantle shown in Figure 3-3.\nThe seismic data to prove the plate tectonic theory was provided to the geological\ncommunity beginning in the 1950s, when the United States was preoccupied with the\ndetection of Soviet nuclear bomb tests. The Eisenhower administration built a worldwide\nnetwork of 125 seismic stations to record ground shaking from nuclear tests, and this\nnetwork also recorded every large earthquake that happened anywhere in the world. By\nthe late 1960s the network had accumulated enough earthquake locations to plot them on\na world map. It became clear that earthquakes do not occur randomly on the surface, but\nin linear belts that wrap around the Earth. This remarkable fact had escaped detection\nuntil the seismic network was constructed. \n\n\n        Here is the user question: What are different type world mountains \n\n        If the document contains keyword(s) or semantic meaning related to the user question, grade it as relevant. \n\n        Give a binary score 'yes' or 'no' score to indicate whether the document is relevant to the question."}, {'role': 'user', 'content': 'Hello! How can I assist you today?'}, {'role': 'assistant', 'content': 'Hi'}], 'temperature': 0.7, 'max_tokens': 1200, 'tools': [{'type': 'function', 'function': {'name': 'grade', 'description': 'Binary score for relevance check.', 'parameters': {'type': 'object', 'properties': {'binary_score': {'description': "Relevance score 'yes' or 'no'", 'type': 'string'}}, 'required': ['binary_score']}}}], 'tool_choice': 'auto'}
---CHECK RELEVANCE---
June 10, 2024 > 18:44:29 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:377 | Received response from llm June 10, 2024 > 18:44:29 | INFO | utils.ias_openai_langchain:ias_openai_chat_completion_with_tools:378 | {'status': 'success', 'result': '{"content": null, "role": "assistant", "tool_calls": [{"function": {"arguments": "{\\n  \\"binary_score\\": \\"yes\\"\\n}", "name": "grade"}, "id": "call_HuDSJ00w7uqfzK3TBA2f3jD7", "type": "function"}]}', 'totalTokens': 1546} June 10, 2024 > 18:44:29 | DEBUG | utils.ias_openai_langchain:_generate:1146 | Total tokens consumed: 1546
---DECISION: DOCS RELEVANT---"Output from node 'retrieve':"'---'{ 'messages': [ ToolMessage(content='Label the Map\nHimalaya Mountains\nIndian Ocean\nArabian Sea\nBangaloreNew Delhi\nMumbai\nKalkutta\n\n© Roger N. Anderson\n15Volcanoes and Plate Tectonics\nThe continents  grow by this same collision process because they are made up of\nrock that is lighter than oceanic rock and thus more difficult to subduct. Some of this\nlight rock is “scraped-off”. Also, at subduction zones, the oceanic plate is melted back\ninto the mantle and the lightest and most buoyant of this magma escapes back to the\nsurface forming volcanoes.  This combination creates the largest mountain ranges on\nEarth, such as the Andes, the Sierra Nevadas, and the Himalayas (Figure 3-12). These\nmountain ranges are the predominant mechanism by which the continents grow new rock.\nThis subduction process is also one of the reasons why earthquakes and volcanoes occur\nat the same places on the planet.\nThe sea floor is relatively simple geologically because it is never at the surface to\nsuffer erosion. All sea floor older than 160 million years has been subducted back into the\nmantle. Complexity is bred by multiple overprinting events through a long geological\nhistory. The longer a feature remains on the surface, the more complex and more difficult\nto decipher it becomes. Thus, plate tectonics was not discovered until the simplicity of\nthe ocean floor was realized. The continents are light, and they float like blocks of wood\nin the bathtub of the heavy ocean-floor rock. They float because they are made of some\nof the lightest rock on the planet. Continents are hard to force down a subduction zone\nbecause they are so light. Therefore, continents have grown throughout geological time\nand so are much more complex than the oceans. More on that in Topic 4.\nFigure 3-12. The magnetic stripes off the western U.S.show sea floor about to be subducted beneath\nWashington, Oregon, and Northern California resulting in volcanoes like Mts. Ranier, Hood, and St.\nHelens.\n\n© Roger N. Anderson\n22zone must overcome the hydrostatic weight of the entire column of water standing in the\nmineral lattices.\nMost of the activity that affects man in a subduction zone occurs landward of the\nAccretionary wedge and trench axis. Volcanoes made from dewatering of the downgoing\nslab come to the surface in either continental mountains or in island arcs, but always on\nthe landward side. Whether the volcanoes form islands or become part of a large\nmountain range has to do with the previous geological history of the plate margin\ncolliding with the subducting plate. If it is continental, a mountain range will be formed\nbecause all the volcanic activity from subduction will be piled on top of an already\nemergent coastline. Examples are the Andes of South America and the volcanoes of\nCentral America. If however, the overriding plate is oceanic, new volcanoes must begin\nby piling lavas onto the sea floor. They emerge as islands only after they have flowed\nenough magma to build a pyramid tall enough to break the sea surface.  Examples are\nGuam in the west Pacific where the Pacific plate is subducting beneath the Philippine\nplate and the Sandwich Islands between South America and Antarctica where the Atlantic\nplate is subducting beneath the Scotia plate (Figure 3-16).\nFigure 3-16. Island arcs can be seen in the western Pacific (upper left) and the southern Atlantic (lower\nright) where subduction is of an oceanic plate beneath another oceanic plate.\nIsland arcs are the early beginnings of new continents. They are arcuate (curved)\nbecause the subducting slab is a plane penetrating into a sphere. The surface expressions\nof volcanic plumes moving directly to the surface from such a plane define an arc.\nVolcanoes appear at the surface spaced about 100 km apart. That is the segregation\ndistance for the production of enough magma along the slab to produce individual\nmagma diapirs, which then congeal and move upward to the surface. If volcanism\ncontinues, enough rock is extruded to completely fill all the space between individual\nvolcanoes to the point that sea level is exceeded even between volcanoes and a new\ncontinent appears.\n\n© Roger N. Anderson\n4Each of these three plate boundaries is characterized by a different kind of force:\ntension from extension at mid-ocean ridge spreading center boundaries; compression\nfrom collision at subduction zones; and shearing from tearing at transform faults (figure\n3-3).\nFigure 3-3. The three types of Plate boundaries are shown at top, and where they occur within a cross\nsection of the Nazca and Pacific Plates sliced open from South America on the right to Tahiti on the left.\nEvidence for Plate Tectonics\nHow is it that we know that the Earth is covered with a mosaic of rigid plates, and\nthat these plates interact with each other only at their common boundaries. The discovery\nat the foundation of Plate Tectonics is that the surface of the Earth is capped by rigid\nouter or lithospheric plates that are only a hundred kilometers or so thick.  These plates\n“float” on a softer, partially liquid upper mantle.\nSeismology provides the most compelling evidence for the existence of these\nlithospheric plates. Earthquakes predominantly occur only along plate boundaries\n(shallow earthquakes in black in figure 3-4), and not inside the interior of the plates.\nSimply observing where the earthquakes are delineates the plate boundaries.  Deep (in\nred, Figure 3-4) and intermediate depth earthquakes (green in Figure 3-4) define the\nsubduction back into the mantle shown in Figure 3-3.\nThe seismic data to prove the plate tectonic theory was provided to the geological\ncommunity beginning in the 1950s, when the United States was preoccupied with the\ndetection of Soviet nuclear bomb tests. The Eisenhower administration built a worldwide\nnetwork of 125 seismic stations to record ground shaking from nuclear tests, and this\nnetwork also recorded every large earthquake that happened anywhere in the world. By\nthe late 1960s the network had accumulated enough earthquake locations to plot them on\na world map. It became clear that earthquakes do not occur randomly on the surface, but\nin linear belts that wrap around the Earth. This remarkable fact had escaped detection\nuntil the seismic network was constructed.', name='retrieve_blog_posts', id='d5a7f097-addf-47cf-b8e2-32cb85ed9dd5', tool_call_id='call_ngjKUKzmYhFSerhxGAPEhQ3D')]}'\n---\n'---GENERATE---
